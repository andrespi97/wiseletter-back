generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id                 Int            @id @default(autoincrement())
  name               String
  surname            String?
  email              String         @unique
  password           String
  role               String?
  course             String?
  active             Boolean        @default(true)
  accepNotifications Boolean        @default(true)
  createdAt          DateTime       @default(now())
  updatedAt          DateTime       @updatedAt
  folders            Folder[]
  Newsletter         Newsletter[]
  rates              Rate[]
  subscriptions      Subscription[]
  newsletters        Newsletter[]   @relation("UserNewsletters")
}

model Category {
  id          Int          @id @default(autoincrement())
  name        String       @unique
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  newsletters Newsletter[] @relation("CategoryNewsletters")
}

model Rate {
  idUser       Int
  idNewsletter Int
  value        Int
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  newsletter   Newsletter @relation(fields: [idNewsletter], references: [id])
  user         User       @relation(fields: [idUser], references: [id])

  @@id([idUser, idNewsletter])
}

model Folder {
  id          Int          @id @default(autoincrement())
  name        String
  idUser      Int
  createdAt   DateTime     @default(now())
  user        User         @relation(fields: [idUser], references: [id])
  newsletters Newsletter[]
}

model Subscription {
  id           Int        @id @default(autoincrement())
  idUser       Int
  idNewsletter Int
  createdAt    DateTime   @default(now())
  newsletter   Newsletter @relation(fields: [idNewsletter], references: [id])
  user         User       @relation(fields: [idUser], references: [id])

  @@unique([idUser, idNewsletter])
}

model Newsletter {
  id            Int            @id @default(autoincrement())
  title         String
  description   String
  active        Boolean        @default(true)
  url           String         @unique
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  idFolder      Int?
  idUserCreator Int
  language      String?
  userCreator   User           @relation(fields: [idUserCreator], references: [id])
  folder        Folder?        @relation(fields: [idFolder], references: [id])
  rates         Rate[]
  subscriptions Subscription[]
  categories    Category[]     @relation("CategoryNewsletters")
  User          User[]         @relation("UserNewsletters")
}
